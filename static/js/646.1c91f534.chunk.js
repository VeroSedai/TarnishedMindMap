/*! For license information please see 646.1c91f534.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkreact_elden_ring_mind_map=self.webpackChunkreact_elden_ring_mind_map||[]).push([[646],{8646:(t,n,e)=>{e.r(n),e.d(n,{CommentsAnnotationPin:()=>p});var i=e(4994),o=e(6505),s=(e(5575),e(3504)),a=e(8068),r=e(5555),l=e(3999);(0,i.y)();var d=(0,r.D)(l.a),c=[d.styles,s.c],p=class extends d{constructor(){super(),this.focusInput=()=>{var t,n;this.inputElement||(this.inputElement=null==(n=null==(t=this.shadowRoot)?void 0:t.querySelector("superviz-comments-comment-input"))?void 0:n.shadowRoot.querySelector("textarea")),this.inputElement.focus()},this.setInputSide=()=>{let t="right"===this.commentsSide?320:0,n=this.annotationSides.right+293,e=this.containerSides.right-t;if(n<e)return void(this.horizontalSide="right");t="left"===this.commentsSide?320:0;let i=this.annotationSides.left-293,o=this.containerSides.left+t;this.horizontalSide=i>o?"left":o-i>n-e?"right":"left"},this.createComment=t=>{let{detail:n}=t;this.annotationSent=!0,document.body.dispatchEvent(new CustomEvent("create-annotation",{detail:(0,i.g)((0,i.A)({},n),{position:(0,i.g)((0,i.A)({},this.originalPosition),{type:"canvas"})})})),this.annotation=null},this.cancelTemporaryAnnotation=()=>{this.annotation=null},this.cancelTemporaryAnnotationEsc=t=>{this.annotation=null},this.avatar=()=>{if("add"===this.type&&!this.showInput)return l.V`<div
        class="comments__annotation-pin__avatar comments__annotation-pin__avatar--add"
      >
        <superviz-icon name="add"></superviz-icon>
      </div>`;let t=this.userAvatar;return t?l.V`<div class="comments__annotation-pin__avatar">
        <img src=${t} />
      </div>`:l.V`<div class="comments__annotation-pin__avatar">
      <p class="text text-bold text-big">${this.userInitial}</p>
    </div>`},this.input=()=>{if(this.showInput&&!this.annotationSent)return l.V`<div class="floating-input">
      <superviz-comments-comment-input
        @create-annotation=${this.createComment}
        eventType="create-annotation"
        @comment-input-ready=${this.focusInput}
        participantsList=${JSON.stringify(this.participantsList)}
      >
      </superviz-comments-comment-input>
    </div>`},this.position={x:0,y:0},setTimeout((()=>{this.firstLoad=!1}),800)}updated(t){super.updated(t),t.has("movedPosition")&&this.annotationSides&&(this.annotationSides=this.pinAnnotation.getBoundingClientRect(),this.setInputSide(),this.inputElement&&this.focusInput())}firstUpdated(t){var n;super.firstUpdated(t),a.n.call(this,["comments"]),this.showInput&&(this.originalPosition=(0,i.A)({},this.position),this.pinAnnotation=null==(n=this.shadowRoot)?void 0:n.querySelector(".comments__annotation-pin"),this.annotationSides=this.pinAnnotation.getBoundingClientRect(),this.setInputSide())}connectedCallback(){if(super.connectedCallback(),"add"!==this.type)return;let{localParticipant:t}=this.useStore("global-store");t.subscribe((t=>{var n;this.localAvatar=null==(n=null==t?void 0:t.avatar)?void 0:n.imageUrl,this.localName=null==t?void 0:t.name})),window.document.body.addEventListener("close-temporary-annotation",this.cancelTemporaryAnnotation),window.document.body.addEventListener("keyup",(t=>{"Escape"===t.key&&this.cancelTemporaryAnnotationEsc(t)}))}disconnectedCallback(){super.disconnectedCallback(),"add"===this.type&&(window.document.body.removeEventListener("close-temporary-annotation",this.cancelTemporaryAnnotation),window.document.body.removeEventListener("keyup",(t=>{"Escape"===t.key&&this.cancelTemporaryAnnotationEsc(t)})))}get userAvatar(){var t,n,e,i;return(null==(i=null==(e=null==(n=null==(t=this.annotation)?void 0:t.comments)?void 0:n.at(0))?void 0:e.participant)?void 0:i.avatar)||this.localAvatar}get userInitial(){var t,n,e,i,o;return((null!=(o=null==(i=null==(e=null==(n=null==(t=this.annotation)?void 0:t.comments)?void 0:n.at(0))?void 0:e.participant)?void 0:i.name)?o:this.localName)||"Anonymous")[0].toUpperCase()}emitClick(){var t;document.body.dispatchEvent(new CustomEvent("select-annotation",{detail:{uuid:null==(t=this.annotation)?void 0:t.uuid}}))}render(){let t={"comments__annotation-pin":!0,preload:void 0===this.firstLoad,"comments__annotation-pin--active":this.active,"comments__cursor-pointer":"add"===this.type&&!this.showInput,"comments__annotation-pin--add":"add"===this.type&&this.showInput,[this.horizontalSide]:!0},n={"comments__annotation-pin-wrapper":!0,"comments__annotation-pin-wrapper--new":this.newPin},e=this.keepPositionRatio?"%":"px",i=`top: ${this.position.y}${e}; left: ${this.position.x}${e};`;return"add"===this.type?l.V`
        <div class=${(0,o.u)(t)} style=${i}>${this.avatar()} ${this.input()}</div>
      `:l.V`<div class=${(0,o.u)(n)} style=${i}>
      <div @click=${this.emitClick} class=${(0,o.u)(t)}>${this.avatar()}</div>
    </div> `}};p.styles=c,p.properties={type:{type:String},annotation:{type:Object},position:{type:Object},active:{type:Boolean},showInput:{type:Boolean},containerSides:{type:Object},horizontalSide:{type:String},commentsSide:{type:String},movedPosition:{type:String},pinAnnotation:{type:Object},localAvatar:{type:String},annotationSent:{type:Boolean},localName:{type:String},keepPositionRatio:{type:Boolean},participantsList:{type:Object},firstLoad:{type:Boolean},newPin:{type:Boolean}},p=(0,i.e)([(0,l.t)("superviz-comments-annotation-pin")],p)},5575:(t,n,e)=>{e.d(n,{E:()=>i,a:()=>o,i:()=>s}),(0,e(4994).y)();var i={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},o=t=>function(){for(var n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];return{_$litDirective$:t,values:e}},s=class{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,n,e){this.t=t,this._$AM=n,this.i=e}_$AS(t,n){return this.update(t,n)}update(t,n){return this.render(...n)}}},8068:(t,n,e)=>{function i(t){let n=document.getElementById(`superviz-${t}-styles`);if(!n)return;let e=new CSSStyleSheet;e.replaceSync(n.textContent),this.shadowRoot.adoptedStyleSheets=[...this.shadowRoot.adoptedStyleSheets,e]}e.d(n,{n:()=>i}),(0,e(4994).y)()},6505:(t,n,e)=>{e.d(n,{u:()=>a});var i=e(5575),o=e(3999),s=e(4994);(0,s.y)();var a=(0,i.a)(class extends i.i{constructor(t){var n;if(super(t),t.type!==i.E.ATTRIBUTE||"class"!==t.name||(null==(n=t.strings)?void 0:n.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter((n=>t[n])).join(" ")+" "}update(t,n){let[e]=n;var i,s;if(void 0===this.st){this.st=new Set,void 0!==t.strings&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter((t=>""!==t))));for(let t in e)e[t]&&(null==(i=this.nt)||!i.has(t))&&this.st.add(t);return this.render(e)}let a=t.element.classList;for(let o of this.st)o in e||(a.remove(o),this.st.delete(o));for(let o in e){let t=!!e[o];t===this.st.has(o)||null!=(s=this.nt)&&s.has(o)||(t?(a.add(o),this.st.add(o)):(a.remove(o),this.st.delete(o)))}return o.E}});(0,s.y)()}}]);
//# sourceMappingURL=646.1c91f534.chunk.js.map